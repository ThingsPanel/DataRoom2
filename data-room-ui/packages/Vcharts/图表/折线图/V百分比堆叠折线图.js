// 配置版本号\nconst version = \'2024051714\';\n// 标题\nconst title = \'V百分比堆叠折线图\';\n// 用于标识，唯一\nconst name = \'V百分比堆叠折线图\';\n// 组件类型标识\nconst type = \'customComponent\';\n// VChart 图表类型标识\nconst chartType = \'line\';\n\n// 右侧配置项 (百分比堆叠折线图)\nconst setting = [\n  { label: \'X轴字段\', type: \'select\', field: \'xField\', optionField: \'xField\', multiple: false, value: \'\', tabName: \'data\' }, // 对应 type\n  { label: \'Y轴字段\', type: \'select\', field: \'yField\', optionField: \'yField\', multiple: false, value: \'\', tabName: \'data\' }, // 对应 value\n  { label: \'系列字段\', type: \'select\', field: \'seriesField\', optionField: \'seriesField\', multiple: false, value: \'\', tabName: \'data\' }, // 对应 country\n  // 样式配置\n  { label: \'启用百分比堆叠\', type: \'switch\', field: \'percent\', optionField: \'percent\', value: true, tabName: \'custom\', groupName: \'graph\' }, // 同时会隐含 stack: true\n  { label: \'显示系列标签\', type: \'switch\', field: \'lineLabelVisible\', optionField: \'lineLabel.visible\', value: false, tabName: \'custom\', groupName: \'label\' }, // 百分比图标签可能重叠，默认关闭\n  { label: \'显示点\', type: \'switch\', field: \'pointVisible\', optionField: \'point.visible\', value: true, tabName: \'custom\', groupName: \'graph\' },\n  { label: \'点的大小\', type: \'inputNumber\', field: \'pointSize\', optionField: \'point.style.size\', value: 4, min: 0, tabName: \'custom\', groupName: \'graph\' },\n  { label: \'线的宽度\', type: \'inputNumber\', field: \'lineWidth\', optionField: \'line.style.lineWidth\', value: 2, min: 0, tabName: \'custom\', groupName: \'graph\' },\n  { label: \'显示图例\', type: \'switch\', field: \'legendVisible\', optionField: \'legends.0.visible\', value: true, tabName: \'custom\', groupName: \'legend\' },\n  // 通用配置\n  { label: \'主题选择\', type: \'select\', field: \'chartTheme\', optionField: \'theme\', options: [], value: \'light\', tabName: \'custom\', groupName: \'graph\' },\n  { label: \'Option 覆盖 (JSON)\', type: \'textarea\', field: \'optionOverride\', optionField: \'\', value: \'{}\', tabName: \'custom\', groupName: \'graph\' }\n];\n\n// 示例数据 (与堆叠折线图相同)\nconst data = {\n  id: \'percentStackedLineData\',\n  values: [\n    { type: \'Nail polish\', country: \'Africa\', value: 4229 }, { type: \'Nail polish\', country: \'EU\', value: 4376 },\n    { type: \'Nail polish\', country: \'China\', value: 3054 }, { type: \'Nail polish\', country: \'USA\', value: 12814 },\n    // ... 更多数据 ...\n    { type: \'Mascara\', country: \'Africa\', value: 18712 }, { type: \'Mascara\', country: \'EU\', value: 6134 },\n    { type: \'Mascara\', country: \'China\', value: 10419 }, { type: \'Mascara\', country: \'USA\', value: 11261 }\n  ]\n};\n\n// 默认 VChart Option (Spec) for Percentage Stacked Line Chart\nconst option = {\n  type: \'line\',\n  data: [data],\n  percent: true, // 启用百分比堆叠\n  stack: true,   // 百分比堆叠需要 stack: true\n  xField: \'type\',\n  yField: \'value\',\n  seriesField: \'country\',\n  lineLabel: { // 系列标签配置\n    visible: false // 百分比图标签易重叠，默认关闭\n  },\n  point: { // 点配置\n    visible: true,\n    style: {\n      size: 4\n    }\n  },\n  line: { // 线配置\n    style: {\n      lineWidth: 2\n    }\n  },\n  axes: [ // 轴配置\n    { orient: \'bottom\', type: \'band\', visible: true },\n    { \n      orient: \'left\', \n      type: \'linear\', \n      visible: true,\n      label: { \n        // formatMethod 将在 optionHandler 中处理\n      } \n    }\n  ],\n  legends: [{ // 图例配置\n    visible: true,\n    position: \'middle\',\n    orient: \'bottom\'\n  }],\n  tooltip: { visible: true }\n};\n\nconst dataHandler = `return data;`;\n\n// Option 处理函数: 根据 percent 设置 Y 轴标签格式化\nconst optionHandler = `\nfunction handleOption(option, config) {\n  const isPercent = config.setting.find(s => s.field === \'percent\')?.value;\n  const yAxisIndex = option.axes?.findIndex(axis => axis.orient === \'left\');\n\n  if (yAxisIndex !== -1 && option.axes[yAxisIndex]) {\n    if (!option.axes[yAxisIndex].label) { option.axes[yAxisIndex].label = {}; }\n    \n    if (isPercent) {\n      option.axes[yAxisIndex].label.formatMethod = (val) => {\n        const num = Number(val);\n        if (isNaN(num)) { return val; }\n        return \`\${(num * 100).toFixed(0)}%\`; // 显示整数百分比\n      };\n      // 确保 stack 为 true\n      option.stack = true;\n    } else {\n      // 如果不启用百分比，移除格式化方法\n      delete option.axes[yAxisIndex].label.formatMethod;\n      // stack 状态可以根据需要保留或删除，这里假设非百分比时也不堆叠\n      // delete option.stack; \n    }\n  }\n  \n  // 根据需要同步 stack 设置项的值 (如果 setting 中有 stack 开关)\n  // const stackSwitch = config.setting.find(s => s.field === \'stack\');\n  // if (stackSwitch) { stackSwitch.value = !!option.stack; }\n\n  return option;\n}\n`;\n\nexport default {\n  version, title, name, type, chartType, option, setting, dataHandler, optionHandler\n};\ 